<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Search Algorithm Visualizer</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app">
      <header>
        <div class="logo"><span>{ AI }</span> Search Visualizer</div>
        <div class="header-tabs">
          <button class="tab-btn active" onclick="setMode('single')">
            Single
          </button>
          <button class="tab-btn" onclick="setMode('compare')">
            Compare 2
          </button>
          <button class="tab-btn" onclick="setMode('triple')">Compare 3</button>
        </div>
        <div style="margin-left: auto; display: flex; gap: 8px">
          <button
            class="btn btn-secondary"
            onclick="showChart()"
            style="font-size: 11px"
          >
            üìä Chart
          </button>
          <button
            class="btn btn-secondary"
            onclick="exportResults()"
            style="font-size: 11px"
          >
            üíæ Export
          </button>
        </div>
      </header>

      <div class="main">
        <!-- Sidebar -->
        <div class="sidebar">
          <!-- Grid settings -->
          <div class="control-group">
            <div class="section-title">Grid Settings</div>
            <label
              >Size: <span id="sizeVal">20</span>√ó<span id="sizeVal2"
                >20</span
              ></label
            >
            <input
              type="range"
              id="gridSize"
              min="8"
              max="40"
              value="20"
              oninput="onGridSizeChange(this.value)"
            />
            <div style="height: 8px"></div>
            <label>Algo 1</label>
            <select id="algo1" onchange="updateAlgoBadge(0)">
              <option value="bfs">BFS ‚Äî Breadth First Search</option>
              <option value="dfs">DFS ‚Äî Depth First Search</option>
              <option value="ucs">UCS ‚Äî Uniform Cost Search</option>
              <option value="gbfs">Greedy Best First Search</option>
              <option value="astar" selected>A* Search</option>
            </select>
            <div id="algo2row" style="margin-top: 8px">
              <label>Algo 2</label>
              <select id="algo2" onchange="updateAlgoBadge(1)">
                <option value="bfs" selected>BFS ‚Äî Breadth First Search</option>
                <option value="dfs">DFS ‚Äî Depth First Search</option>
                <option value="ucs">UCS ‚Äî Uniform Cost Search</option>
                <option value="gbfs">Greedy Best First Search</option>
                <option value="astar">A* Search</option>
              </select>
            </div>
            <div id="algo3row" style="margin-top: 8px; display: none">
              <label>Algo 3</label>
              <select id="algo3">
                <option value="bfs">BFS</option>
                <option value="dfs" selected>DFS</option>
                <option value="ucs">UCS</option>
                <option value="gbfs">Greedy</option>
                <option value="astar">A*</option>
              </select>
            </div>
          </div>

          <!-- Edit mode -->
          <div class="control-group">
            <div class="section-title">Edit Mode</div>
            <div class="mode-btns">
              <button
                class="mode-btn start-mode active"
                onclick="setEditMode('start')"
                id="modeStart"
              >
                üü¢ Start
              </button>
              <button
                class="mode-btn goal-mode"
                onclick="setEditMode('goal')"
                id="modeGoal"
              >
                üî¥ Goal
              </button>
              <button
                class="mode-btn wall-mode"
                onclick="setEditMode('wall')"
                id="modeWall"
              >
                ‚¨õ Wall
              </button>
              <button
                class="mode-btn"
                onclick="setEditMode('erase')"
                id="modeErase"
              >
                üßπ Erase
              </button>
              <button
                class="mode-btn weight-mode"
                onclick="setEditMode('weight')"
                id="modeWeight"
              >
                ‚öñÔ∏è Weight
              </button>
              <button
                class="mode-btn"
                onclick="setEditMode('none')"
                id="modeNone"
              >
                üñ±Ô∏è Drag
              </button>
            </div>
            <div style="height: 8px"></div>
            <div class="btn-row">
              <button class="btn btn-secondary" onclick="randomMaze()">
                üé≤ Maze
              </button>
              <button class="btn btn-secondary" onclick="clearWalls()">
                üóëÔ∏è Clear
              </button>
              <button class="btn btn-secondary" onclick="resetGrid()">
                ‚Ü∫ Reset
              </button>
            </div>
          </div>

          <!-- Heuristic -->
          <div class="control-group">
            <div class="section-title">Heuristic Function</div>
            <div class="heuristic-tabs">
              <button
                class="htab active"
                onclick="setHeuristicMode('preset', this)"
              >
                Preset
              </button>
              <button class="htab" onclick="setHeuristicMode('custom', this)">
                Custom
              </button>
              <button class="htab" onclick="setHeuristicMode('table', this)">
                Table
              </button>
            </div>
            <div id="hPreset">
              <select id="heuristicPreset">
                <option value="manhattan">Manhattan Distance</option>
                <option value="euclidean">Euclidean Distance</option>
                <option value="chebyshev">Chebyshev Distance</option>
                <option value="zero">Zero (Dijkstra-like)</option>
              </select>
            </div>
            <div id="hCustom" style="display: none">
              <label>Formula (use x,y,goal_x,goal_y):</label>
              <input
                type="text"
                id="customHeuristic"
                value="Math.abs(x-goal_x)+Math.abs(y-goal_y)"
                placeholder="abs(x-goal_x)+abs(y-goal_y)"
              />
              <div
                style="font-size: 10px; color: var(--text-dim); margin-top: 4px"
              >
                Variables: x, y, goal_x, goal_y
              </div>
              <button
                class="btn btn-secondary"
                onclick="testHeuristic()"
                style="margin-top: 6px; width: 100%"
              >
                Test Formula
              </button>
            </div>
            <div id="hTable" style="display: none">
              <label>Manual h(n) table (row,col=value):</label>
              <textarea
                id="hTableInput"
                placeholder="0,0=5&#10;0,1=4&#10;..."
              ></textarea>
              <button
                class="btn btn-secondary"
                onclick="parseHTable()"
                style="margin-top: 6px; width: 100%"
              >
                Apply Table
              </button>
            </div>
          </div>

          <!-- Legend -->
          <div class="control-group">
            <div class="section-title">Legend</div>
            <div class="legend">
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--start)"></div>
                Start
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--goal)"></div>
                Goal
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--open)"></div>
                Frontier
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--closed)"></div>
                Visited
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--path)"></div>
                Path
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--wall)"></div>
                Wall
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--weight)"></div>
                Weight
              </div>
              <div class="legend-item">
                <div class="legend-dot" style="background: var(--empty)"></div>
                Empty
              </div>
            </div>
          </div>
        </div>

        <!-- Content -->
        <div class="content">
          <div class="grids-area" id="gridsArea">
            <!-- Panel 1 -->
            <div class="grid-panel" id="panel0">
              <div class="panel-header">
                <span class="panel-title">Algorithm 1</span>
                <span class="algo-badge badge-astar" id="badge0">A*</span>
                <div class="panel-stats">
                  <div class="stat">
                    Expanded: <span id="expanded0">0</span>
                  </div>
                  <div class="stat">Cost: <span id="cost0">‚Äî</span></div>
                  <div class="stat">Steps: <span id="steps0">0</span></div>
                </div>
                <div
                  id="status0"
                  class="status-msg status-none"
                  style="margin-left: 8px"
                >
                  READY
                </div>
              </div>
              <div class="grid-wrapper">
                <canvas id="canvas0"></canvas>
              </div>
            </div>

            <!-- Panel 2 -->
            <div class="grid-panel" id="panel1" style="display: none">
              <div class="panel-header">
                <span class="panel-title">Algorithm 2</span>
                <span class="algo-badge badge-bfs" id="badge1">BFS</span>
                <div class="panel-stats">
                  <div class="stat">
                    Expanded: <span id="expanded1">0</span>
                  </div>
                  <div class="stat">Cost: <span id="cost1">‚Äî</span></div>
                  <div class="stat">Steps: <span id="steps1">0</span></div>
                </div>
                <div
                  id="status1"
                  class="status-msg status-none"
                  style="margin-left: 8px"
                >
                  READY
                </div>
              </div>
              <div class="grid-wrapper">
                <canvas id="canvas1"></canvas>
              </div>
            </div>

            <!-- Panel 3 -->
            <div class="grid-panel" id="panel2" style="display: none">
              <div class="panel-header">
                <span class="panel-title">Algorithm 3</span>
                <span class="algo-badge badge-dfs" id="badge2">DFS</span>
                <div class="panel-stats">
                  <div class="stat">
                    Expanded: <span id="expanded2">0</span>
                  </div>
                  <div class="stat">Cost: <span id="cost2">‚Äî</span></div>
                  <div class="stat">Steps: <span id="steps2">0</span></div>
                </div>
                <div
                  id="status2"
                  class="status-msg status-none"
                  style="margin-left: 8px"
                >
                  READY
                </div>
              </div>
              <div class="grid-wrapper">
                <canvas id="canvas2"></canvas>
              </div>
            </div>
          </div>

          <!-- Controls bar -->
          <div class="controls-bar">
            <button class="btn btn-success" id="btnStart" onclick="startAll()">
              ‚ñ∂ Start
            </button>
            <button
              class="btn btn-secondary"
              id="btnPause"
              onclick="pauseAll()"
              disabled
            >
              ‚è∏ Pause
            </button>
            <button
              class="btn btn-secondary"
              id="btnResume"
              onclick="resumeAll()"
              disabled
            >
              ‚ñ∂ Resume
            </button>
            <button class="btn btn-primary" id="btnStep" onclick="stepAll()">
              ‚è≠ Step
            </button>
            <button class="btn btn-danger" onclick="resetAll()">‚ü≥ Reset</button>
            <div class="speed-control">
              <span>Speed:</span>
              <input type="range" id="speedSlider" min="1" max="10" value="5" />
              <span id="speedVal">5</span>
            </div>
          </div>

          <!-- Comparison bar -->
          <div class="comparison-bar" id="compBar" style="display: none">
            <div class="comp-stats" id="compLeft">
              <div class="comp-stat">
                <div class="comp-stat-value" id="cExpanded0">0</div>
                <div class="comp-stat-label">Expanded</div>
              </div>
              <div class="comp-stat">
                <div class="comp-stat-value" id="cCost0">‚Äî</div>
                <div class="comp-stat-label">Path Cost</div>
              </div>
              <div class="comp-stat">
                <div class="comp-stat-value" id="cTime0">‚Äî</div>
                <div class="comp-stat-label">Time (ms)</div>
              </div>
              <div class="comp-stat">
                <div class="comp-stat-value" id="cOptimal0">?</div>
                <div class="comp-stat-label">Optimal?</div>
              </div>
            </div>
            <div class="comp-center">
              <div class="vs-badge">VS</div>
              <div class="winner-badge" id="winnerBadge">‚Äî</div>
            </div>
            <div
              class="comp-stats"
              id="compRight"
              style="justify-content: flex-end"
            >
              <div class="comp-stat">
                <div class="comp-stat-value" id="cExpanded1">0</div>
                <div class="comp-stat-label">Expanded</div>
              </div>
              <div class="comp-stat">
                <div class="comp-stat-value" id="cCost1">‚Äî</div>
                <div class="comp-stat-label">Path Cost</div>
              </div>
              <div class="comp-stat">
                <div class="comp-stat-value" id="cTime1">‚Äî</div>
                <div class="comp-stat-label">Time (ms)</div>
              </div>
              <div class="comp-stat">
                <div class="comp-stat-value" id="cOptimal1">?</div>
                <div class="comp-stat-label">Optimal?</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Chart modal -->
    <div class="chart-overlay" id="chartOverlay" onclick="closeChart(event)">
      <div class="chart-modal">
        <div class="chart-title">
          <span>üìä Expanded Nodes Comparison</span>
          <button
            class="btn btn-secondary"
            onclick="closeChart(null)"
            style="padding: 4px 10px; font-size: 11px"
          >
            ‚úï
          </button>
        </div>
        <div class="chart-canvas-wrap">
          <canvas id="chartCanvas"></canvas>
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>
    <script src="script.js"></script>
  </body>
</html>
